<div
  class="flex items-center justify-center w-full"
  [ngClass]="{ 'cursor-not-allowed opacity-50': !fileName() }"
>
  <label
    for="dropzone-file"
    class="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg bg-gray-50 hover:bg-gray-100 relative"
    [ngClass]="{
      'cursor-not-allowed': selectedFile || hasExistingFile || !fileName(),
      'cursor-pointer': !selectedFile && !hasExistingFile && fileName(),
      'border-blue-500 bg-blue-50': isDragging
    }"
  >
    @if(isUploading){
    <div class="absolute top-2 w-[90%]">
      <div class="relative w-full bg-gray-200 rounded h-4 overflow-hidden">
        <div
          class="bg-green-500 h-full rounded transition-all duration-200"
          [style.width.%]="progress"
        ></div>
        <span
          class="absolute inset-0 flex items-center justify-center text-xs font-medium text-white"
        >
          {{ progress }}%
        </span>
      </div>
    </div>
    } @if(!selectedFile && !hasExistingFile){
    <div class="flex flex-col items-center justify-center pt-5 pb-6">
      <mat-icon>cloud_upload</mat-icon>
      <p class="mb-2 text-sm text-gray-500">
        <span class="font-semibold">Click para subir</span> o arrastra y suelta
      </p>
      <p class="text-xs text-gray-500">SVG, PNG, JPG</p>
    </div>
    } @if((selectedFile || hasExistingFile) && !isUploading){
    <div
      class="absolute bottom-2 flex items-center space-x-2 bg-white p-2 rounded shadow cursor-auto"
    >
      <span class="text-sm text-gray-700">{{
        selectedFile?.name || displayedFileName
      }}</span>
      <button
        type="button"
        (click)="removeFile(); $event.stopPropagation()"
        mat-fab
        color="warn"
        matTooltip="Eliminar archivo"
      >
        <mat-icon>delete</mat-icon>
      </button>
    </div>
    }

    <input
      #fileInput
      id="dropzone-file"
      type="file"
      accept="image/*"
      class="hidden"
      (change)="onFileSelected($event)"
      [disabled]="selectedFile || hasExistingFile || !fileName()"
    />
  </label>
</div>
